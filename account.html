<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="assets/logo.PNG" class="h-5">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@glidejs/glide/dist/css/glide.core.min.css">
  <script src="https://cdn.jsdelivr.net/npm/@glidejs/glide/dist/glide.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
  <title>My Account</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 min-h-screen flex flex-col items-center justify-start py-10 relative">

  <!-- Background Image -->
  <div class="absolute inset-0 z-0">
    <img src="assets/banner.jpeg" alt="Background" class="w-full h-full object-cover">
    <div class="absolute inset-0 bg-black/80"></div> <!-- Dark overlay with low opacity -->
  </div>

  <!-- User Account Card -->
  <div
    class="bg-gray-700/5 backdrop-blur-sm rounded-2xl shadow-2xl shadow-gray-800 p-6 w-full max-w-md flex flex-col items-center relative z-10">

    <!-- Profile Display -->
    <div id="profileDpContainer" class="w-32 h-32 rounded-full overflow-hidden mb-4 border-4 border-[#12a16b]">
      <img id="currentDp" src="assets/user.jpg" alt="Profile Picture" class="w-full h-full object-cover">
    </div>

    <!-- User Name -->
    <h2 id="userName" class="text-xl font-semibold mb-4 text-white">User Name</h2>

    <!-- File Upload Section -->
    <div class="mb-0 w-full flex flex-col items-center">
      <!-- Hidden input -->
      <input type="file" id="uploadDp" class="hidden">

      <!-- Custom button -->
      <label for="uploadDp"
        class="cursor-pointer bg-gradient-to-br from-[#14b87a] via-[#12a16b] to-[#0e8055] hover:bg-gradient-to-bl focus:ring-2 focus:outline-none focus:ring-[#12a16acb] dark:focus:ring-green-900 font-medium rounded-full py-2 px-5 text-center cursor-pointer whitespace-nowrap transition hover:translate-y-1 duration-[200ms]  shadow-[0_0_25px_#33997a6e]">
        Change Profile Picture
      </label>

      <!-- Selected file name -->
      <p id="fileName" class="mt-2 text-sm text-gray-500"></p>
    </div>

    <!-- Logout / Web Button -->
    <div class="flex gap-4 mt-6">
      <button id="logoutBtn"
        class="bg-[#12a16b] hover:bg-[#0f8859] text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-200">
        Logout
      </button>
      <button id="webBtn"
        class="bg-white hover:bg-gray-200 text-[#0f8859] font-semibold py-2 px-4 rounded-lg shadow-md transition duration-200">
        Go to Web
      </button>
    </div>
  </div>

  <script>
    // Load user from localStorage
    let user = JSON.parse(localStorage.getItem("user")) || null;

    const currentDp = document.getElementById("currentDp");
    const userName = document.getElementById("userName");
    const fileInput = document.getElementById("uploadDp");

    // If user is logged in, show DP and name
    if (user) {
      // Show username set at registration
      if (user.username) {
        userName.textContent = user.username;
      } else {
        userName.textContent = "User Name";
      }

      // Show DP if exists
      if (user.dp) {
        currentDp.src = user.dp;
      }
    } else {
      // Redirect to register page if not logged in
      window.location.href = "register.html";
    }

    // File upload change (DP update)
    fileInput.addEventListener("change", function () {
      const file = this.files[0];
      if (file) {
        // Show the uploaded image only, no file name displayed
        const reader = new FileReader();
        reader.onload = function (e) {
          currentDp.src = e.target.result;

          // Save updated DP to localStorage
          if (user) {
            user.dp = e.target.result;
            localStorage.setItem("user", JSON.stringify(user));
          }
        };
        reader.readAsDataURL(file);
      }
    });

    // Logout button
    document.getElementById("logoutBtn").addEventListener("click", function () {
      localStorage.removeItem("user");
      window.location.href = "login.html";
    });

    // Go to Web button
    document.getElementById("webBtn").addEventListener("click", function () {
      window.location.href = "index.html";
    });
  </script>
</body>

</html>